global:
  imageRegistry: docker.m.daocloud.io
  postgresql:
    auth:
      username: bn_mlflow
      password: bn_mlflow
      database: bn_mlflow

image:
  registry: docker.m.daocloud.io

gitImage:
  registry: docker.m.daocloud.io

volumePermissions:
  image:
    registry: docker.m.daocloud.io

waitContainer:
  image:
    registry: docker.m.daocloud.io

primary:
  name: primary
  initdb:
    scripts:
      create_mlflow_user_and_dbs.sh: |
        #!/bin/bash
        set -e
        PGPASSWORD=bn_mlflow psql -v ON_ERROR_STOP=1 --username "bn_mlflow" <<-EOSQL
            SELECT 'CREATE DATABASE bn_mlflow_auth'
            WHERE NOT EXISTS (SELECT FROM pg_database WHERE datname = 'bn_mlflow_auth')\gexec
            GRANT ALL PRIVILEGES ON DATABASE bn_mlflow_auth TO bn_mlflow;
        EOSQL